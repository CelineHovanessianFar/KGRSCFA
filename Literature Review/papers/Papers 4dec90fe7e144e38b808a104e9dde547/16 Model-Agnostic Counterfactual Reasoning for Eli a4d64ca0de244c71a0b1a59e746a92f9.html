<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>16: Model-Agnostic Counterfactual Reasoning for Eliminating Popularity Bias in Recommender System</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="a4d64ca0-de24-4c71-a0b1-a59e746a92f9" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/attachment_lightgray.svg"/></div><h1 class="page-title">16: Model-Agnostic Counterfactual Reasoning for Eliminating Popularity Bias in Recommender System</h1><p class="page-description"></p></header><div class="page-body"><p id="0c5226a1-088f-4e91-824d-576e18bdffc1" class="">Features:</p><p id="4a699963-3c8d-4045-8191-996c3f3b73e0" class="">
</p><p id="cdbf0a7a-93bb-4d48-943f-798e145f4e99" class="">Questions:</p><p id="94099fca-b0f1-45f2-97eb-65e81f351774" class="">
</p><hr id="a74b647e-1069-4045-95a8-018dc7a9de87"/><p id="02ac2ac8-ec88-4c3b-99ea-dd13b71592c4" class="">The authors developed a Model-Agnostic Counterfactual Reasoning (MACR) framework for recommender systems to <mark class="highlight-orange_background">eliminate popularity bias</mark> by using causal graphs and counterfactual inference. They implemented multi-task learning to isolate the effects of item popularity from genuine user preferences during training and adjusted the final recommendation scores by estimating and subtracting the direct impact of item popularity using counterfactual scenarios during inference. This approach allows integration with various existing recommender models to enhance recommendation fairness and diversity.</p><hr id="9d01f881-6433-46b0-9416-1a3b8fbe9c16"/><h2 id="a7b40874-53da-49c8-bc8d-df60a91b2ffd" class="">Genearal Summary</h2><p id="811af0e9-e18f-492a-b6a7-d54092e7417f" class="">The paper <mark class="highlight-orange_background">discusses addressing the issue of popularity bias in recommender systems </mark>through a novel <mark class="highlight-orange_background">model-agnostic counterfactual reasoning</mark> (MACR) approach. <mark class="highlight-orange_background">Popularity bias causes widely known items to be recommended more frequently,</mark> overshadowing less popular items. This effect can skew the user&#x27;s true preferences, making the recommender system less effective at personalization.</p><p id="c2681ff5-ca63-408a-b684-72e3e00f173d" class="">To combat this, the authors<mark class="highlight-orange_background"> propose using causal reasoning</mark> to<mark class="highlight-orange_background"> identify and eliminate the direct effects of item popularity on recommendation scores</mark>. They introduce a <mark class="highlight-orange_background">causal graph</mark> that delineates the cause-effect relationships in the recommendation process and apply multi-task learning to evaluate the influence of each causal link on the recommendations.</p><p id="1cb82350-913b-44f1-8da0-3b744967cc67" class="">Their methodology involves not only adjusting the training process but also <mark class="highlight-orange_background">applying counterfactual inference during the prediction phase</mark> to <mark class="highlight-orange_background">remove the influence of item popularity</mark>. The framework is flexible and can be incorporated into existing recommender systems. The effectiveness of the MACR framework is validated through experiments on multiple real-world datasets, showing significant improvements over traditional methods, especially in reducing the impact of popular items and increasing the visibility of long-tail items.</p><p id="5c310d3d-ebba-4e65-9daa-c2cf4e18d000" class="">Overall, the paper offers a fresh perspective on handling popularity bias by blending causal reasoning with practical recommender system design, presenting a scalable solution applicable across various models and datasets.</p><hr id="3211d930-cff4-4dad-a642-e8c29e440bb3"/><h2 id="8965e0f9-f7d1-4869-8a51-ca102fb8e493" class="">Technical Aspects</h2><p id="7880e4d1-e5e5-402f-9af0-e14949c1e9a9" class="">The paper proposes a sophisticated framework called Model-Agnostic Counterfactual Reasoning (MACR) to address the issue of popularity bias in recommender systems. Here’s a breakdown of the technical aspects of their solution:</p><h3 id="7e43599f-2ed2-4bdc-a058-e12ff62e3c43" class=""><strong>1. Causal Graph</strong></h3><p id="41143d87-df1c-4b11-95b5-25ae9d5df367" class="">The authors<mark class="highlight-orange_background"> start by defining a causal graph that maps out the relationships within the recommendation system.</mark> This graph includes nodes for users, items, and the interactions between them, structured to capture direct and indirect effects that contribute to the final recommendation scores. This setup helps to isolate the effect of item popularity from other influencing factors.</p><h3 id="3c0a8a0b-6c03-4f1f-991f-a214f84f1261" class=""><strong>2. Multi-task Learning</strong></h3><p id="a87f3bb8-0fcc-447a-8f7e-694439b1b1f4" class="">In the training phase, MACR uses multi-task learning to separate the influence of different factors on the recommendations:</p><ul id="90e59ae5-cfc7-4345-b8b8-cf37b8dc7fd4" class="bulleted-list"><li style="list-style-type:disc"><strong>Main Task</strong>: This is the <mark class="highlight-orange_background">primary recommendation task,</mark> which predicts whether a user would like an item based on the user’s past interactions.</li></ul><ul id="8423b157-8b82-40e7-8350-84d7bc58b21b" class="bulleted-list"><li style="list-style-type:disc"><strong>Auxiliary Tasks</strong>: These tasks are designed to isolate and learn the direct influence of item popularity and other factors separately. By doing so, the model can understand how much of the recommendation decision is influenced by item popularity versus genuine user interest.</li></ul><h3 id="a9491fbe-3f80-4f52-9c80-dca11ea91056" class=""><strong>3. Counterfactual Inference</strong></h3><p id="393f0373-511b-4fe3-8cdb-8f765f2c6d1e" class="">The key to the MACR framework is the use of counterfactual inference during the prediction phase. This method involves:</p><ul id="e8ab5701-2ccf-45d9-8a44-c3859dcb633e" class="bulleted-list"><li style="list-style-type:disc"><strong>Estimating Direct Effects</strong>: <mark class="highlight-orange_background">The framework calculates what the recommendation score for an item would be if the influence of its popularity were entirely removed. </mark>This is done by considering a <mark class="highlight-orange_background">&quot;counterfactual world&quot;</mark> where the item&#x27;s popularity is not known to the system.</li></ul><ul id="234611f3-9a7d-43c6-a2ef-dfed47518286" class="bulleted-list"><li style="list-style-type:disc"><strong>Adjusting Scores</strong>: The final scores are adjusted by removing the estimated direct effects of popularity, thus leading to a debiased recommendation list where items are suggested based on user preference rather than popularity.</li></ul><h3 id="63082c06-71d7-4acd-aa17-9ad0b589f794" class=""><strong>4. Model-Agnostic Approach</strong></h3><p id="13b88db0-a772-41fb-8d49-849c43e67c73" class="">One of the standout features of MACR is its model-agnostic nature, meaning it can be implemented on top of any existing recommendation framework without specific adjustments to the underlying model architecture. Whether the base model is a matrix factorization, a neural network, or a graph-based model, MACR can be applied to adjust its output.</p><h3 id="8fa4b1b7-fd62-4c78-8a44-1321c596a7d7" class=""><strong>5. Implementation Details</strong></h3><p id="668ffaf7-6cda-489c-9501-d287d43189a5" class="">In practical terms, the implementation involves:</p><ul id="a05aa449-145c-483d-a4ec-9d32833e4b22" class="bulleted-list"><li style="list-style-type:disc">Defining additional neural network layers or modules that represent the user and item influences separately.</li></ul><ul id="361b8e3c-1ea0-497c-8b66-cdda546f9b59" class="bulleted-list"><li style="list-style-type:disc">During training, these modules learn to predict the influence of popularity and other factors independently.</li></ul><ul id="9da0f1dc-73c2-4053-b6e5-e7cf75a38743" class="bulleted-list"><li style="list-style-type:disc">In the prediction phase, the outputs from these modules are used to adjust the main recommendation scores through a formula that subtracts the estimated popularity effect.</li></ul><h3 id="acbc7ff7-71af-4f2e-a9ac-d356377cb774" class=""><strong>6. Evaluation</strong></h3><p id="d0c17d40-7553-4910-bfa7-769b1a2b7b53" class="">The authors validate their approach using real-world datasets and show that it effectively reduces popularity bias, improves the diversity of recommendations, and enhances the overall performance of the recommender system compared to both traditional and other state-of-the-art debiasing methods.</p><p id="95139cad-797e-4192-bd87-6553edbf4512" class="">Overall, the technical contribution of this work lies in creatively applying causal inference to understand and mitigate the impact of popularity in recommender systems, providing a new way to enhance personalization and recommendation diversity.</p><hr id="81e49b7f-c69a-46d1-9ce1-445459678c0a"/><h2 id="45d581b4-2927-4b33-8c8e-5c2c2ea78f15" class="">Neural Model and Structural Details</h2><p id="48c1459e-24c1-4bd5-be62-2b42331217f0" class="">
</p><hr id="8dd2360b-e9a6-4ac6-aefa-c68b145477d7"/><h2 id="99966255-9fd3-44fc-ba05-6ded6f533f01" class="">Counterfactual Concept</h2><p id="857adbe0-e35c-459c-aefe-3ec8cfe7bc9b" class="">The concept of counterfactuals is central to the paper&#x27;s methodology for addressing popularity bias in recommender systems. In causal inference, counterfactual reasoning involves imagining alternative scenarios (&quot;what-if&quot; situations) to evaluate the effect of a specific cause on an outcome. In this context, the authors utilize counterfactuals to estimate and then subtract the direct effect of item popularity on recommendation scores. Here&#x27;s a detailed explanation of how the counterfactual concept is introduced and implemented in their solution:</p><h3 id="674d6cfc-2ff8-4f59-82f7-041d1d361b6c" class=""><strong>Introduction of Counterfactual Concept</strong></h3><ol type="1" id="4700660f-51bc-46df-af0b-ad5f78171e2e" class="numbered-list" start="1"><li><strong>Causal Graph Formulation</strong>: The authors first construct a causal graph that illustrates the cause-effect relationships influencing recommendation decisions. This graph helps in identifying the direct paths through which item popularity affects recommendation scores.</li></ol><ol type="1" id="a43f6fb6-c7e4-4f72-877a-691b51d8c763" class="numbered-list" start="2"><li><strong>Direct and Indirect Effects</strong>: In the causal graph, they differentiate between direct effects (from item popularity directly to the recommendation score) and indirect effects (where the popularity influences the score through other mediating variables like user-item interactions).</li></ol><h3 id="1b0263ea-0e7e-478a-8d44-f1bf3fb8e4ce" class=""><strong>Implementation of Counterfactual Reasoning</strong></h3><ol type="1" id="0b77bd3b-ca50-4860-826c-4442be27d328" class="numbered-list" start="1"><li><strong>Counterfactual Inference for Popularity Debiasing</strong>: The implementation of counterfactual reasoning involves several key steps:<ul id="be2ff60a-9f58-4f38-8770-4d707c61586c" class="bulleted-list"><li style="list-style-type:disc"><strong>Identifying Direct Effects</strong><mark class="highlight-orange_background">: They identify the direct causal path from item popularity to the recommendation score in the causal graph.</mark></li></ul><ul id="5562073f-e60e-4818-9c9a-a1d11c295e47" class="bulleted-list"><li style="list-style-type:disc"><strong>Estimating the Counterfactual</strong>: <mark class="highlight-orange_background">For each item, they estimate what the recommendation score would be if the item&#x27;s popularity were not a factor.</mark> This is done by modeling how the score would look under a hypothetical scenario where the item is assumed to have an average or neutral popularity.</li></ul></li></ol><ol type="1" id="8f762bb8-bd4e-4b1b-89fb-c1bc6461e729" class="numbered-list" start="2"><li><strong>Adjusting Recommendation Scores</strong>: Once the counterfactual scores (i.e., scores without the influence of popularity) are estimated, these are used to adjust the actual recommendation scores. The adjustment is typically calculated as the difference between the actual score and the counterfactual score. This difference represents the bias introduced by item popularity.<ul id="166a8ed9-f3b5-44f7-997d-2cac56f15216" class="bulleted-list"><li style="list-style-type:disc"><strong>Score Adjustment Formula</strong>: In practical terms, the adjusted score for an item might be calculated using a formula like:<p id="a95cb855-4196-4fcb-952a-785a185f9878" class="">Adjusted Score=Actual Score−(Influence of Popularity)Adjusted Score=Actual Score−(Influence of Popularity)</p></li></ul><p id="a2bd59b4-b718-4a5b-9fc5-2220e5de29d3" class="">This formula ensures that the item’s intrinsic qualities, rather than its popularity, are the primary drivers of its recommendation score.</p></li></ol><ol type="1" id="6de36c6e-e5b6-4cd7-8339-7cd09653602e" class="numbered-list" start="3"><li><strong>Implementation Details</strong>:<ul id="86c3a912-bb47-4307-b325-078bead9d1b6" class="bulleted-list"><li style="list-style-type:disc"><strong>Multi-Task Learning</strong>: During the training phase, the framework learns to separate the contributions of various factors (like user preferences and item popularity) to the recommendation score. This separation is critical for accurately estimating the direct effect of popularity.</li></ul><ul id="57ea1707-3671-4ece-886e-21b68ee29a26" class="bulleted-list"><li style="list-style-type:disc"><strong>Neural Network Architecture</strong>: They likely use separate modules or layers within a neural network to model the direct and indirect effects, facilitating the isolation and subsequent subtraction of the popularity effect.</li></ul></li></ol><h3 id="b8429ba2-63ea-491f-b8ce-09255ad1410c" class=""><strong>Evaluation of Counterfactual Reasoning</strong></h3><ul id="d5e27b94-f8a9-4776-aacb-e7c15422fcd2" class="bulleted-list"><li style="list-style-type:disc"><strong>Testing the Effectiveness</strong>: The authors test the effectiveness of their counterfactual approach by comparing the performance of the recommender system before and after the adjustment for popularity bias. They use metrics like accuracy, diversity, and novelty to assess improvements in recommendation quality.</li></ul><p id="4250ecb7-a0ee-4699-8c10-c8c7c7f39775" class="">In summary, the counterfactual reasoning in their solution involves modeling and removing the direct influence of item popularity on recommendation scores. This process is facilitated by a structured causal analysis and implemented through adjustments to the scores based on estimates of what they would be in a world without popularity bias. This method allows the recommender system to focus more accurately on user preferences and less on the inherent bias towards popular items.</p><hr id="dfbb34d5-2ce4-480d-b480-24c485f88dd6"/><h3 id="f723b956-d53b-4a8d-8d80-ca2ab9f0be38" class="">When making modifications to the graph for the counterfactual scenarios, do they directly make any changes to the embeddings?</h3><p id="5ac313c4-797d-47a8-b8d1-0ec86c80be53" class="">In the described framework of the paper, the authors <mark class="highlight-orange_background">do not directly modify the embeddings for counterfactual scenarios</mark> in the traditional sense of altering the embedding vectors themselves. Instead, they use a model-agnostic approach that operates at the level of the scoring and inference processes. Here&#x27;s how it essentially works:</p><ol type="1" id="e21ba203-4ea6-4054-931e-f49108a8b3f8" class="numbered-list" start="1"><li><strong>Separate Learning Tasks</strong>: They implement separate modules within their framework to learn about item popularity and user-item interaction effects independently. These are likely represented by different parts of the network that output their own predictions or scores based on the input embeddings.</li></ol><ol type="1" id="28730334-9b99-4f87-92d0-7b3214d8a8bc" class="numbered-list" start="2"><li><strong>Counterfactual Inference</strong>: During the inference phase, the system computes what the recommendation score for an item would be if the item&#x27;s popularity were not considered. This is done by estimating the direct impact of item popularity on the score and then mathematically removing this effect.</li></ol><ol type="1" id="74aed3fc-539b-4194-a19e-dab00e287154" class="numbered-list" start="3"><li><strong>Score Adjustment</strong>: The final score for each item is adjusted by subtracting the calculated influence of item popularity from the originally predicted score. This adjusted score aims to reflect the user&#x27;s preference more accurately, free from the bias of item popularity.</li></ol><p id="941b0b42-4be2-4577-ae63-01a1e953d7dc" class="">Thus, <mark class="highlight-orange_background">the modification for counterfactual scenarios occurs not at the embedding level but at the scoring and inference levels. </mark>They adjust the impact that certain features (like item popularity) have on the final outcome, rather than altering the representation of items or users directly in the embedding space. This approach allows the framework to be model-agnostic, applying broadly across different types of recommender systems without needing specific changes to how embeddings are generated.</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>